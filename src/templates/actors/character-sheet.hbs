<form class="sheet" autocomplete="off">
    <header class="sheet-header">
        <img class="profile" src="{{actor.img}}" data-tooltip="{{actor.name}}" data-edit="img" />
        <section class="header-details flexcol">
            <h1 class="document-name">{{actor.name}}</h1>
            <section>
                <span class="ancestry">{{ localize ancestryLabel }}</span>
                <span class="paths">{{ localize pathsLabel }}</span>
            </section>
        </section>
    </header>

    <hr />
    <section class="attribute-groups flexrow">
        {{#each attributeGroups as |attrGroup|}}
        <section class="attribute-group" data-id="{{attrGroup.id}}">
            {{!-- Header --}}
            <span class="label">
                {{ localize attrGroup.config.label }}
            </span>

            {{!-- Attributes and defense --}}
            <section class="attributes flexrow">
                {{#with attrGroup.attributes.[0] as |attribute|}}
                <div class="attribute flexcol" data-id="{{attribute.id}}">
                    <span class="box-title">
                        {{ localize attribute.config.label }}
                    </span>
                    <span class="value">
                        <input type="number" class="value" min="0" max="5" step="1"
                            name="system.attributes.{{attribute.config.key}}.value" value="{{attribute.value}}" />
                    </span>
                </div>
                {{/with}}

                {{#with attrGroup.defense as |defense|}}
                <div class="defense">
                    <span class="box-title">{{ localize "COSMERE.Actor.Statistics.Defense"}}</span>
                    <div class="defense-box">
                        <span class="value">{{ derived defense.value }}</span>
                    </div>
                </div>
                {{/with}}

                {{#with attrGroup.attributes.[1] as |attribute|}}
                <div class="attribute flexcol" data-id="{{attribute.id}}">
                    <span class="box-title">
                        {{ localize attribute.config.label }}
                    </span>
                    <span class="value">
                        <input type="number" class="value" min="0" max="5" step="1"
                            name="system.attributes.{{attribute.config.key}}.value" value="{{attribute.value}}" />
                    </span>
                </div>
                {{/with}}
            </section>
        </section>
        {{/each}}
    </section>

    <section class="sheet-body">
        <div class="skills flexcol" data-group="primary" data-tab="skills">
            <section class="attribute-groups flexrow">
                {{#each attributeGroups as |attrGroup|}}

                <section class="attribute-groups flexcol">


                    <section class="skills flexcol">
                        {{!-- Resource --}}
                        {{#with attrGroup.resource as |resource|}}
                        <div class="resource flexrow" data-id="{{resource.id}}">
                            <div class="flexcol">
                                <span class="label">
                                    {{ localize resource.config.label}}
                                </span>
                                <span class="value">
                                    {{resource.value}} / {{resource.max.value}}
                                </span>
                            </div>
                            {{#if resource.deflect includeZero=true}}
                            <div class="deflect flexcol">
                                <span class="label">{{ localize "COSMERE.Actor.Statistics.Deflect"}}</span>
                                <span class="value">{{ resource.deflect.value }}</span>
                            </div>
                            {{/if}}
                        </div>
                        {{/with}}
                        {{!-- Skills --}}
                        <ul class="skill-list">
                            {{#each attrGroup.skills as |skill|}}
                            {{#if skill.active}}
                            <li class="skill" data-id="{{skill.id}}">
                                <div class="mod-box rollable">
                                    <span class="mod">+{{derived skill.mod }}</span>
                                </div>

                                <div class="label rollable">
                                    <span>{{ localize skill.config.label }}</span>
                                    <span style="text-transform: uppercase">({{ localize skill.config.attrLabel
                                        }})</span>
                                </div>
                                <div class="skill-pips ranks">
                                    <ul class="pip-skills">
                                        <a data-action="adjust-skill-rank" data-id="{{skill.id}}"
                                            data-tooltip="Left Click to increase {{localize skill.config.label}}'s Rank<br>Right Click to decrease {{localize skill.config.label}}'s Rank">
                                            {{#times skill.rank}}<li class="fa-solid fa-dot-circle"></li>
                                            {{/times}}
                                            {{#times (sub 5 skill.rank)}}<li class="fa-regular fa-circle"></li>
                                            {{/times}}
                                        </a>
                                    </ul>
                                </div>
                            </li>

                            {{/if}}
                            {{/each}}
                        </ul>
                    </section>
                </section>
                {{/each}}
                <!--{{#each attributeGroups as |attrGroup|}}
                {{/each}}-->
            </section>
        </div>
    </section>

    <section class="documents">
        <section class="favorites">


        </section>

        {{!-- <div class="tab biography flexrow" data-group="primary" data-tab="biography"></div> --}}

        <section class="tabs">
            {{!-- Navigation --}}
            <nav class="sheet-navigation flexrow">
                <a class="tab-item {{#if (eq tab " actions")}}active{{/if}}" data-tab="actions">{{ localize
                    "COSMERE.Actor.Sheet.Actions.label" }}</a>
                <a class="tab-item {{#if (eq tab " inventory")}}active{{/if}}" data-tab="inventory">{{ localize
                    "COSMERE.Actor.Sheet.Inventory.label" }}</a>
            </nav>

            <section class="tab-body">
                <div class="scroll-container">
                    {{!-- Actions tab --}}
                    <div class="tab actions {{#if (eq tab " actions")}}active{{/if}}" data-tab="actions">
                        {{> actions sections=items.actions }}
                    </div>

                    {{!-- Inventory tab --}}
                    <div class="tab inventory {{#if (eq tab " inventory")}}active{{/if}}" data-tab="inventory">
                        {{> inventory sections=items.inventory }}

                        {{!-- TODO: Currency --}}
                    </div>
                </div>
            </section>
        </section>
    </section>
    </section>

</form>